<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Restructuring Tool</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">

    <!-- HighlightJS -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js"></script>

    <!-- SortableJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.2/Sortable.min.js"></script>

    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <header class="app-header">
        <div class="logo">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="3" y1="9" x2="21" y2="9"></line>
                <line x1="9" y1="21" x2="9" y2="9"></line>
            </svg>
            JSON Restructuring Tool
        </div>
        <div class="header-actions">
            <!-- potential toolbar actions -->
        </div>
    </header>

    <main class="app-grid">
        <!-- LEFT PANEL: Data Source -->
        <section class="panel left-panel">
            <div class="panel-header">
                <h2>1. Input Data</h2>
                <button id="btn-parse" class="btn btn-primary sm">Parse</button>
            </div>
            <div class="panel-content section-input">
                <textarea id="json-input" placeholder="Paste your complex JSON here..."></textarea>
                <div id="json-input-preview-container" class="hidden"
                    style="position: absolute; inset: 16px; background: #282c34; border-radius: 4px; border: 1px solid var(--border); overflow: hidden; display: flex; flex-direction: column;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 4px 12px; border-bottom: 1px solid var(--border); background: var(--bg-panel);">
                        <span
                            style="font-size: 0.75rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.05em;">Formatted
                            Input</span>
                        <button id="btn-edit-input" class="btn btn-ghost sm"
                            style="font-size: 0.7rem; padding: 2px 6px;">âœŽ Edit Raw</button>
                    </div>
                    <pre
                        style="margin: 0; padding: 12px; flex: 1; overflow: auto; font-family: var(--font-mono); font-size: 0.8rem; line-height: 1.4;"><code id="json-input-preview" class="language-json"></code></pre>
                </div>
                <div id="parse-error" class="error-toast hidden"></div>
            </div>
        </section>

        <!-- CENTER PANEL: Canvas -->
        <section class="panel center-panel">
            <div class="panel-header">
                <h2>3. Schema Canvas</h2>
                <div class="canvas-actions" style="display: flex; gap: 8px;">
                    <button id="btn-add-object" class="btn btn-primary shadow-glow sm">+ Add Object</button>
                    <button id="btn-clear-canvas" class="btn btn-ghost sm">Clear Canvas</button>
                </div>
            </div>
            <div class="panel-content section-canvas">
                <div class="canvas-helptext">
                    Drag keys from the palette. Nest tokens inside each other to group by that key. Toggle "Group/Field"
                    to control behavior.
                </div>
                <div id="canvas-root" class="canvas-container sortable-container">
                    <!-- Root dropzone -->
                </div>
                <!-- Trash Zone inside content flow but fixed at bottom -->
                <div class="trash-zone-wrapper">
                    <div id="trash-zone" class="trash-zone">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                            </path>
                        </svg>
                        Drop here to delete
                    </div>
                </div>
            </div>
        </section>

        <!-- RIGHT PANEL: Output Preview -->
        <section class="panel right-panel">
            <div class="panel-header">
                <h2>4. Output Preview</h2>
                <div style="display: flex; gap: 8px;">
                    <button id="btn-convert" class="btn btn-primary shadow-glow sm" disabled>Convert</button>
                    <button id="btn-download" class="btn btn-secondary sm" disabled>Download .json</button>
                </div>
            </div>
            <div class="panel-content section-preview">
                <pre><code id="json-preview" class="language-json">Output preview will appear here...</code></pre>
            </div>
        </section>
    </main>

    <script src="app.js"></script>
</body>

</html>